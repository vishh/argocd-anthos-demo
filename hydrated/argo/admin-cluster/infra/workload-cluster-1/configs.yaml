apiVersion: compute.cnrm.cloud.google.com/v1beta1
kind: ComputeNetwork
metadata:
  labels:
    owner: platforms-team
    type: production
  name: prod-1-containercluster-vpcnative
  namespace: kcc
spec:
  autoCreateSubnetworks: false
  routingMode: REGIONAL
---
apiVersion: compute.cnrm.cloud.google.com/v1beta1
kind: ComputeSubnetwork
metadata:
  labels:
    owner: platforms-team
    type: production
  name: prod-1-containercluster-vpcnative
  namespace: kcc
spec:
  ipCidrRange: 10.2.0.0/16
  networkRef:
    name: containercluster-vpcnative
  region: us-central1
  secondaryIpRange:
  - ipCidrRange: 10.3.0.0/16
    rangeName: servicesrange
  - ipCidrRange: 10.4.0.0/16
    rangeName: clusterrange
---
apiVersion: container.cnrm.cloud.google.com/v1beta1
kind: ContainerCluster
metadata:
  labels:
    availability: high
    cluster-name: prod-1
    cluster-type: production
    owner: platforms-team
    target-audience: production
    type: production
  name: prod-1-cluster
  namespace: kcc
spec:
  addonsConfig:
    configConnectorConfig:
      enabled: true
    dnsCacheConfig:
      enabled: true
    networkPolicyConfig:
      disabled: false
  clusterAutoscaling:
    autoscalingProfile: BALANCED
    enabled: true
    resourceLimits:
    - maximum: 100
      minimum: 10
      resourceType: cpu
    - maximum: 1000
      minimum: 100
      resourceType: memory
  defaultMaxPodsPerNode: 100
  description: Shared workload cluster meant for production workloads
  enableBinaryAuthorization: true
  enableIntranodeVisibility: true
  enableShieldedNodes: true
  initialNodeCount: 1
  ipAllocationPolicy:
    clusterSecondaryRangeName: clusterrange
    servicesSecondaryRangeName: servicesrange
  location: us-central1
  maintenancePolicy:
    dailyMaintenanceWindow:
      startTime: "00:00"
  networkPolicy:
    enabled: true
  networkRef:
    name: containercluster-dep-vpcnative
  networkingMode: VPC_NATIVE
  nodeLocations:
  - us-central1-a
  notificationConfig:
    pubsub:
      enabled: true
      topicRef:
        name: containercluster-dep-vpcnative
  podSecurityPolicyConfig:
    enabled: true
  releaseChannel:
    channel: STABLE
  subnetworkRef:
    name: prod-1-containercluster-vpcnative
  verticalPodAutoscaling:
    enabled: true
  workloadIdentityConfig:
    identityNamespace: vishnuk-cloud.svc.id.goog
---
apiVersion: gkehub.cnrm.cloud.google.com/v1beta1
kind: GKEHubMembership
metadata:
  labels:
    cluster-name: prod-1
    cluster-type: production
    owner: platforms-team
    type: production
  name: prod-1-gkehubmembership
  namespace: kcc
spec:
  authority:
    issuer: https://container.googleapis.com/v1/projects/vishnuk-cloud/locations/us-central1/clusters/prod-1-cluster
  description: Registering GKE cluster prod-1-cluster
  endpoint:
    gkeCluster:
      resourceRef:
        name: prod-1-cluster
  location: global
